"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7133],{71786:function(t,n,e){e.d(n,{GH:function(){return A},Ie:function(){return k},NM:function(){return b},R0:function(){return O},kS:function(){return v},oO:function(){return g},pH:function(){return D},tf:function(){return L},z8:function(){return _}});var o=e(15861),r=e(4942),i=e(71002),c=e(87757),a=e.n(c),u=(e(83464),e(95566),e(19496),e(58109),e(68438),e(3967)),s=e(19272),f=e(56477),l=e(25538),d=e(51569),p=e(14567),w=e(56241);function h(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function m(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?h(Object(e),!0).forEach((function(n){(0,r.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var g=function(t){return function(n,e){if("object"===(0,i.Z)(t)){var o=Object.keys(t),r={},c=(0,l.Z)(e());o.forEach((function(n){!Array.isArray(t[n])&&"object"===(0,i.Z)(t[n])&&t[n]?r[n]=m(m({},c[n]),t[n]):r[n]=t[n]})),n({type:s._,payload:r})}}},v=function(t){return function(n){!t&&(0,u.Ut)(),(0,u.Sw)(),(0,u.D_)(),n((function(t){t({type:s.i})}))}},y=function(){},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return function(n){var e=function(e){n(g({waitingOnCheck:!1})),t(e)};u.Dl.loginRadiusInit("ssoNotLoginThenLogout",{onSuccess:function(){window.LoginRadiusSDK.authenticationApi.getProfileByAccessToken(window.localStorage.getItem("LRTokenKey"),null,(function(t,o){if(t)return e(t);n(P({waitingOnCheck:!1,isAuthenticated:!0},o,window.localStorage.getItem("LRTokenKey"))),n(C()),n(R(o.Uid))}))},onError:e})}},P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0;return function(o){if(n.ErrorCode)return o(g({userProfile:null,isAuthenticated:!1}));if(t.userProfile=n,null===n.Email)o(g(t));else{o(g(t)),(0,u.Uq)(e).then((function(t){o(g({community:t,viafouraLogin:!0}))}));var r=(0,u.ws)(n,"Email").Value;o(E(r,e)),o(S(r))}}},O=function(t){return new Promise((function(n,e){(0,o.Z)(a().mark((function o(){var r,i,c;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,u.OP)("".concat(f.Lo,"/sott"),{method:"GET"});case 3:if(r=o.sent,i=r.data,c=(0,u.ZU)((0,u.Xh)(m({},t))),""!==i&&""!==i.Sott){o.next=9;break}return e({Message:"Please try again later."}),o.abrupt("return",!1);case 9:window.LoginRadiusSDK.authenticationApi.userRegistrationByEmail(c,i.Sott,f.lh,null,null,"".concat((0,u.a4)()).concat(p.DO),null,(function(o){if(o)return e(o),!1;n(t)})),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(0),w.Z.error("registerNewUser",o.t0),e(o.t0);case 16:case"end":return o.stop()}}),o,null,[[0,12]])})))()}))},E=function(t,n){return function(e){var o="email=".concat(encodeURIComponent(t),"&token=").concat(n);(0,u.OP)("".concat(f.Lo,"/gettvsubscriptions"),{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:o}).then((function(t){var n=t.data;n.length>0&&e(g({watch:n[0].result}))})).catch((function(t){w.Z.error("getUserTvSubscription",t)}))}},S=function(t){return function(n){(0,u.OP)("".concat(f.US,"/user/subscriptions/").concat(t),{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"GET"}).then((function(t){var e=t.data.data;e.length>0&&(e.sort((function(t,n){return t.name<n.name?-1:t.name>n.name?1:0})),n(g({newsletters:e})))})).catch((function(t){w.Z.error("getUserNewsletterSubscriptions",t)}))}},k=function(t){return function(){var n=(0,o.Z)(a().mark((function n(e){var o,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=18;break}return n.prev=1,n.next=4,(0,u.OP)("https://api.loginradius.com/identity/v2/auth/email?".concat((0,d.stringify)({apikey:f._N,welcomeemailtemplate:"",url:"".concat((0,u.a4)()).concat(p.DO),verificationtoken:t})));case 4:if(!(o=n.sent).data.IsPosted||!o.data.Data.access_token){n.next=13;break}return r=o.data.Data.access_token,n.next=9,(0,u.OP)("https://api.loginradius.com/identity/v2/auth/account/sendwelcomeemail?".concat((0,d.stringify)({apikey:f._N,welcomeemailtemplate:f.KN})),{method:"GET",headers:{"content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 9:return n.next=11,(0,u.ZB)(r);case 11:e(P({isAuthenticated:!0},o.data.Data.Profile,r)),e(R(o.data.Data.Profile.Uid));case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(1),e(g({verifySocialFlowError:n.t0}));case 18:case"end":return n.stop()}}),n,null,[[1,15]])})));return function(t){return n.apply(this,arguments)}}()},C=function(){return function(t,n){var e=(0,l.Z)(n()),o=e.evt,r=e.userProfile;o&&!r.EmailVerified&&window.LoginRadiusSDK.authenticationApi.verifyEmail(o,null,"".concat((0,u.a4)()).concat(p.DO),"",(function(n){n?w.Z.error("verifyEmailFlow",n):((0,u.OP)("https://api.loginradius.com/identity/v2/auth/account/sendwelcomeemail?".concat((0,d.stringify)({apikey:f._N,welcomeemailtemplate:f.KN})),{method:"GET",headers:{"content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("LRTokenKey"))}}),r.EmailVerified=!0,t(g({userProfile:r})))}))}},_=function(){return function(t,n){var e=(0,l.Z)(n()),o=e.userProfile,r=e.cevt,i=e.ce;return(0,u.OP)("".concat(f.Lo,"/change_email"),{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:(0,d.stringify)({token:localStorage.getItem("LRTokenKey"),email:i,do_not_change_newsletters_email:!1,verification_token:r})}).then((function(){t(g({updateEmailFlowError:void 0,onLoginRedirectRoute:"/account/profile",userProfile:m(m({},o),{},{EmailVerified:!0,Email:[{Type:"Primary",Value:i}]})}))})).catch((function(n){t(g({onLoginRedirectRoute:"/account/profile",updateEmailFlowError:n}))}))}},L=function(t,n,e){return function(o){var r;"undefined"!==typeof t.Addresses&&t.Addresses.length>1&&(r=t.Addresses.pop()),window.LoginRadiusSDK.authenticationApi.updateProfileByAccessToken(window.localStorage.getItem("LRTokenKey"),t,f.lh,null,null,null,"".concat((0,u.a4)()).concat(p.DO),(function(t,i){!t||t.ErrorCode===u.RJ.EMAIL_ALREADY_IN_USE&&t.ErrorCode===u.RJ.ACCESS_TOKEN_EXPIRED?t?n("Error code: ".concat(t.ErrorCode," - ").concat(t.Message)):"undefined"!==typeof r?window.LoginRadiusSDK.authenticationApi.updateProfileByAccessToken(window.localStorage.getItem("LRTokenKey"),{Addresses:[r]},null,null,null,null,null,(function(t,r){!t.ErrorCode||936===t.ErrorCode&&906===t.ErrorCode?t?n("Error code: ".concat(t.ErrorCode," - ").concat(t.Message)):(o(g({userProfile:r.Data})),e&&e()):n(t)})):(o(g({userProfile:i.Data})),e&&e()):n(t)}))}},D=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){var e=(0,o.Z)(a().mark((function e(o){var r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.LC)(t);case 3:return r=e.sent,i=r.access_token,e.next=7,(0,u.ZB)(i);case 7:o(P({isAuthenticated:!0},r.Profile,i)),o(C()),o(R(r.Profile.Uid)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),n(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},A=function(t,n,e){return function(o){o(L({Email:[{Type:"Primary",Value:t}]},n,e))}},R=function(t){return function(n){(0,u.OP)("".concat(f.a_,"/login"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({"@context":{cbc:"http://vocab.data.cbc.ca/"},"cbc:loginradius_id":t.toString()})}).then((function(t){var e=t.data["cbc:cbc_plus_id"][0];e&&(0,u.hK)(e),n(g({cbc_plus:e}))})).catch((function(t){w.Z.error("getCBCPlusID",t)}))}}},25538:function(t,n,e){var o=(0,e(29998).P1)([function(t){return t.membership}],(function(t){return t}));n.Z=o},29113:function(t,n,e){e.d(n,{Bl:function(){return o},YG:function(){return i},u6:function(){return r}});e(94139);var o=function(t){return/^https?:\/\/.*?cbc(music)?\.ca(:.*?)*\/?(.*?)*/.test(t)},r=function(t){return/^cbc[a-zA-Z]*?:\/\/.*?$/.test(t)},i=function(t){var n,e="",i="Back to CBC.ca";return t.returnto&&(o(t.returnto)||r(t.returnto))&&(n=t.returnto,e=r(n)?n:n.match(/^https?:\/\/([\w-]+\.)+\w+(:\d+)*/)[0],null!==t&&void 0!==t&&t.mobile?i="Back to CBC App":t.returnto.includes("gem.cbc.ca")?i="Back to CBC Gem":t.returnto.includes("cbc.ca/listen")||t.returnto.includes("cbclisten.ca")?(e=t.returnto,i="Back to CBC Listen"):t.returnto.match(/subscriptions|newsletters/g)?i="Back to CBC Newsletters":t.returnto.includes("ask-cbc")?i="Back to Ask CBC":t.returnto.includes("/local")&&(e=t.returnto,i="Back to Local News")),t.returntotext&&(i="Back to ".concat(t.returntotext)),{backButtonUrl:e,buttonDesc:i}}},59272:function(t,n,e){e.d(n,{Cp:function(){return S},EJ:function(){return k},FU:function(){return P},HB:function(){return _},Hm:function(){return B},L9:function(){return y},LC:function(){return l.LC},Ou:function(){return g},Ty:function(){return v},UX:function(){return D},Uw:function(){return C},Xh:function(){return l.Xh},YR:function(){return b},Yy:function(){return T},c0:function(){return E},jd:function(){return A},oT:function(){return L},p6:function(){return m},rm:function(){return l.rm},vf:function(){return O},ws:function(){return l.ws}});e(58109),e(95566),e(68438),e(83464),e(19496);var o=e(29439),r=e(4942),i=(e(18509),e(51631),e(3024),e(21914)),c=e(51569),a=e(43113),u=e(56477),s=e(14567),f=e(56241),l=e(3967),d=e(29113),p=e(56552);function w(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function h(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?w(Object(e),!0).forEach((function(n){(0,r.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):w(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var m=function(t){return(0,a.Z)(new Date(t),"MMM d, yyyy")},g=/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z] ?[0-9][A-Z][0-9]$/i,v=function(t){return s.BA.test(t)},y=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.CBC&&window.CBC.APP&&window.CBC.APP.SC&&window.CBC.APP.SC.EventTracker&&window.CBC.APP.SC.EventTracker.isOn()&&window.CBC.APP.SC.EventTracker.trackEvent(t,h(h({},n),{},{app:{name:"membership-web-app"}}))},b=function(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=(0,c.parse)(null===(n=window.location)||void 0===n?void 0:n.search,{ignoreQueryPrefix:!0}),r=o.referrer;r&&((0,d.Bl)(r)||(0,d.u6)(r))?(r=P(t,r),window.location.href=r):e()},P=function(t,n){if(n&&t){var e=(0,l.YW)();if(e){var o=new URL(n);return o.searchParams.delete("token"),o.searchParams.append("token",e),"".concat(o.href)}return n}return n},O=function(t){return new Promise((function(n,e){window.LoginRadiusSDK.authenticationApi.forgotPassword(t.email,"".concat((0,l.a4)()).concat(s.lI),u.eQ,(function(t){t?e(t):n()}))}))},E=function(t){return new Promise((function(n,e){window.LoginRadiusSDK.authenticationApi.resetPasswordByResetToken(t,(function(t){t?e(t):n()}))}))},S=function(t){return new Promise((function(n,e){window.LoginRadiusSDK.authenticationApi.changePassword(window.localStorage.getItem("LRTokenKey"),t.newpassword,t.oldpassword,(function(t){t?e(t):n()}))}))},k=function(t,n){return new Promise((function(e,o){(0,l.OP)("".concat(u.Lo,"/add_email"),{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:(0,c.stringify)({token:localStorage.getItem("LRTokenKey"),email:t,verificationurl:(0,l.a4)()+s.Sr+"?".concat((0,c.stringify)({ce:t,ceoe:n})),emailtemplate:u.YY})}).then((function(){return e()})).catch((function(t){return o("Bad Request"===(null===t||void 0===t?void 0:t.error)?{ErrorCode:1e3}:t)}))}))},C=function(t,n){return(0,l.OP)("".concat(u.gh,"/users/").concat(t,"?verb=patch&session=").concat(window.localStorage.getItem("_vf_sid")),{method:"POST",body:n})},_=function(t,n){return(0,l.OP)("".concat(u.gh,"/users/").concat(t,"?verb=patch&session=").concat(window.localStorage.getItem("_vf_sid")),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)})},L=function(t,n){(0,l.OP)("".concat(u.gh,"/mutes/").concat(t,"?session=").concat(window.localStorage.getItem("_vf_sid")),{method:"GET"}).then((function(t){var e=t.data;n(e)})).catch((function(t){f.Z.error("getViafouraMuteList",t)}))},D=function(t,n){(0,l.OP)("".concat(u.gh,"/mutes/").concat(t,"?session=").concat(window.localStorage.getItem("_vf_sid")),{method:"DELETE"}).then((function(t){var e=t.data;n(e)})).catch((function(t){f.Z.error("unmuteViafouraUser",t)}))},A=function(t){t.preventDefault();var n=t.currentTarget.dataset.kind,e=window.MSInputMethodContext&&document.documentMode?"&callbacktype=hash":"",o="".concat(u.WB,"?apikey=").concat(u._N,"&provider=").concat(n,"&callback=").concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(e);window.open(o,"_blank","toolbar=0,location=0,menubar=0,width=300,height=500,scrollbars=yes")};function R(t,n){setTimeout((function(){if(window.LoginRadiusV2){clearTimeout(n);var e={apiKey:u._N,appName:u.VQ};if(!document.getElementById("loginradius-lib")){var o=document.createElement("script");o.id="loginradius-lib",o.type="text/javascript",o.src="/a/vendors/LoginRadiusV2SDK.11.0.0.js",o.onload=function(){!function(t,n){try{window.LRObject=new window.LoginRadiusV2(t),window.LoginRadiusSDK.initSDK({apiKey:t.apiKey,debugMode:!0}),window.LR_IS_READY=!0,n()}catch(e){f.Z.error("initializeSDK",e)}}(e,t)},document.body.appendChild(o)}}else R(t,n)}),50)}var T=function(){return new Promise((function(t){window.vfQ=window.vfQ||[],window.vfQ.push((function(){var n=setTimeout((function(){var t=document.createElement("script");t.type="text/javascript",t.src="//auth.lrcontent.com/v2/js/LoginRadiusV2.js",document.body.appendChild(t)}),4e3);R(t,n)}))}))},B=function(t){return(0,i.memo)((function(){var n=(0,i.useState)(!1),e=(0,o.Z)(n,2),r=e[0],c=e[1];return(0,i.useEffect)((function(){window.LR_IS_READY?c(!0):T().then((function(){c(!0)})).catch((function(t){f.Z.error("LOGIN RADIUS ERROR",t)}))}),[]),r&&(0,p.jsx)(t,{})}))}}}]);